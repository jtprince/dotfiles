#!/usr/bin/env ruby


class MPD
  def running?()
    !`mpc status 2>&1`['error: Connection refused']
  end

  def play_pause()
    `mpc toggle`
  end

  def next()
    `mpc next`
  end

  def previous()
    `mpc prev`
  end
end

class Playerctl
  def play_pause()
    `playerctl play-pause`
  end

  def next()
    `playerctl next`
  end

  def previous()
    `playerctl previous`
  end
end


def get_player()
  mpd = MPD.new
  mpd.running? ? mpd : Playerctl.new
end

if ARGV.size != 1
  puts "usage: #{File.basename(__FILE__)} play-pause|next|previous"
  puts "uses mpc if mpd is running, otherwise playerctl"
  exit
end

command = ARGV[0].gsub('-', '_').to_sym
player = get_player
player.send(command)


