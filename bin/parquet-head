#!/usr/bin/env python

import argparse
from pathlib import Path
import pandas as pd


pd.set_option("display.max_columns", None)

parser = argparse.ArgumentParser(
    description="prints headers and first rows of each dataframe"
)
parser.add_argument("parquet_files", type=Path, nargs="+")
parser.add_argument(
    "--no-shape", action="store_true", help="don't print shape at the end"
)
parser.add_argument(
    "--no-attrs", action="store_true", help="don't print df.attrs even if they exist"
)
parser.add_argument(
    "--all",
    action="store_true",
    help="display the whole parquet file, not just the head",
)

args = parser.parse_args()

if args.all:
    pd.set_option("display.max_rows", None)

for path in args.parquet_files:
    print(str(path))
    df = pd.read_parquet(path)

    if df.attrs and not args.no_attrs:
        print("attrs:", df.attrs)

    if args.all:
        print(df)
    else:
        print(df.head())
    if not args.no_shape:
        print("\nshape:", df.shape)
