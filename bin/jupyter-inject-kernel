#!/usr/bin/env python

import argparse
import subprocess
import os

parser = argparse.ArgumentParser(description="inject current python into jupyter as a kernel")
args = parser.parse_args()


env = os.environ.get("CONDA_DEFAULT_ENV")
if not env:
    env = subprocess.check_output("basename $VIRTUAL_ENV", shell=True, text=True)

subprocess.run("pip install ipykernel", shell=True)
subprocess.run(f"python -m ipykernel install --user --name={env}", shell=True)
