#!/bin/bash

function cmd_exists {
    command -v "$1" >/dev/null 2>&1
}

if [ "$1" != "late" ]; then
    xrdb -merge ~/.Xdefaults
    eval $(gnome-keyring-daemon --start --components=gpg,pkcs11,secrets,ssh)
    urxvtd --quiet --opendisplay --fork
    dunst -config ~/.config/dunstrc &
    start-pulseaudio-x11
    xmodmap ~/.config/xmodmap
    thunar --daemon &
    # should probably install pavumeter and paprefs, too
    pasystray &   
    #volti &
    nm-applet &
#    if cmd_exists dropbox ; then
        #( sleep 20 && dropbox start )&
    #fi
    #if [ -e ~/src/copy_agent/copy/x86_64/CopyAgent ]; then
        #( sleep 40 && ~/src/copy_agent/copy/x86_64/CopyAgent& )&
    #fi
    xclip &  # provides a clipboard that can be used across applications
    xscreensaver &
    
    notify-send -u low 'initialized!'
else
    randomise_background.rb
    if [ `hostname` == "prince" ]; then
        notify-send -u low 'chem dirs mounted!'
        mount_chem_dirs.rb all
    fi
    #if [ `hostname` == "altius" ]; then
    #    mount_wd15
    #fi
fi



#eval `dbus-launch --sh-syntax --exit-with-session`
