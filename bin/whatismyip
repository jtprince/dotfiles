#!/usr/bin/ruby -w

if ARGV.include?("-h") or ARGV.include?("--help")
  puts "usage: #{File.basename(__FILE__)} [(l)ocal]]"
  exit
end

if ARGV[0] && ARGV[0][0] == 'l'
  # LAN IP
  if `uname -r` =~ /ARCH/
    reply = `ip addr`.split("\n")
    addr_lines = reply.select do |line|
      line =~ /inet /
    end
    addr_lines.each do |line|
      puts line.split('/').first.strip.split(' ').last
    end
  else
    puts "can't parse this distro ip addr yet"
  end
else
  # WAN IP
  ip = `dig +short myip.opendns.com @resolver1.opendns.com`.chomp
  puts ip
end
