# userguide: http://i3wm.org/docs/userguide.html

# xmodmap -pke # to see most keybindings
# use xev to interactively get most keynames
# use evtest to determine hard-to-get keynames (?? can these be used??)
#
# keys on most of my keyboards not yet being used:
# XF86Documents
# XF86HomePage
# XF86Mail
# XF86Phone
# XF86Back
# XF86Forward
# XF86Calculator
# The alternate F-Lock keys:
#   Help
#   Undo
#   Redo
#   XF86New
#   SunOpen
#   XF86Close
#   XF86Reply
#   XF86MailForward
#   XF86Send
#   XF86Save
#   Print

######################################
# STARTUP PROGRAMS & SETTINGS (Early)
######################################

exec --no-startup-id dbus-launch --sh-syntax --exit-with-session i3 -V -d all > ~/.config/i3/i3log-$(date +'%F-%k-%M-%S') 2>&1
exec --no-startup-id autostart

#########################
# VARIABLES
#########################

## set to Win (then swap Win and Alt in gnome-keyboard)
# alt=Mod1 win=Mod4
set $mod Mod4
## left
set $l Tab
## right
set $r l
## down
set $d j
## up
set $u k
## left (with shift held down)
set $L Tab
## right (with shift held down)
set $R L
## down (with shift held down)
set $D J
## up (with shift held down)
set $U K

#########################
# APPEARANCE
#########################

# font for window titles. ISO 10646 = Unicode
#font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
#font pango:Telegrama 10
font pango:Droid Sans Mono 10

# colors                    border      background  text
client.focused              #77994B     #006600     #FFFFFF
client.focused_inactive     #77994B     #465C86     #FFFFFF
client.unfocused            #465C86     #333333     #CFCFCF
client.urgent               #F00000     #F00000     #000000

#########################
# SOUND
#########################

## parentheses left and right to change volume
bindsym $mod+parenright exec pactl set-sink-volume 0 -- '+5%'
bindsym $mod+parenleft exec pactl set-sink-volume 0 -- '-5%'
bindsym $mod+Shift+M exec toggle_mute
# toggle_mute is two lines:
#/usr/bin/pactl list sinks | grep -q Mute:.yes
#/usr/bin/pactl set-sink-mute 0 ${PIPESTATUS[1]}
bindsym XF86AudioRaiseVolume exec pactl set-sink-volume 0 -- '+5%'
bindsym XF86AudioLowerVolume exec pactl set-sink-volume 0 -- '-5%'
bindsym XF86AudioMute exec toggle_mute
 
# if not using pulseaudio:
#bindsym $mod+parenright exec amixer set Master 5%+
#bindsym $mod+parenleft exec amixer set Master 5%-
#bindsym $mod+m exec amixer set Master toggle

#########################
# Music player
#########################
# commands for mpd
#bindsym XF86AudioNext exec mpc next
#bindsym XF86AudioPlay exec mpc toggle
#bindsym XF86AudioPrev exec mpc prev
# key 1 on my microsoft keyboard
# shuffle the playlist
#bindsym XF86Launch5 exec mpc shuffle

# commands for moc
#bindsym XF86AudioNext exec mocp --next
#bindsym XF86AudioPlay exec mocp --toggle-pause
#bindsym XF86AudioPrev exec mocp --previous
# key 1 on my microsoft keyboard
#bindsym XF86Launch5 exec mocp --toggle shuffle
# play the same song infinitely
#bindsym XF86Favorites exec mocp --on repeat --off autonext
# normal mode (no repeat) autonext
#bindsym XF86Launch9 exec mocp --off repeat --on autonext

# commands for audacious (via audtool which comes with audacious)
bindsym $mod+m exec audacious
bindsym XF86AudioNext exec audtool playlist-advance
bindsym XF86AudioPlay exec audtool playback-playpause
bindsym XF86AudioPrev exec audtool playlist-reverse
bindsym XF86Launch5 exec audtool playlist-shuffle-toggle



# http://wiki.linuxquestions.org/wiki/XF86_keyboard_symbols
# http://praksh.wordpress.com/2010/06/13/moc-the-terminal-music-player-for-all-your-needs/

#########################
# DESKTOP MOVEMENT
#########################

bindsym $mod+period workspace next
bindsym $mod+comma workspace prev
bindsym $mod+Shift+period move workspace next
bindsym $mod+Shift+comma move workspace prev

#########################
# DEFAULTS
#########################

## workspace Layout <default|stacking|tabbed>
workspace_layout stacking

## focus follows mouse <yes|no>
focus_follows_mouse no

## border style for new windows <normal|1pixel|none>
new_window normal

## border style for for floating windows <normal|1pixel|none>
new_float 1pixel

## Automatic back-and-forth when switching to the current workspace
workspace_auto_back_and_forth yes

## orientation for new workspaces <horizontal|vertical|auto>
default_orientation vertical

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

#force_focus_wrapping yes

#########################
# Preferred applications
#########################
# use the system default browser
#set $browser x-www-browser
set $browser chromium-browser
set $newwindow --new-window
#set $browser firefox
#set $newwindow -new-window

# debian/ubuntu default terminal
#set $terminal x-terminal-emulator
set $terminal gnome-terminal

set $filemanager nautilus --no-desktop

bindsym $mod+x exec $terminal

bindsym XF86HomePage exec $browser
bindsym $mod+i exec $browser
bindsym $mod+z exec firefox

bindsym XF86Mail exec $browser $newwindow http://gmail.com
bindsym $mod+e exec $browser $newwindow http://gmail.com

bindsym $mod+c exec $browser $newwindow http://calendar.google.com
bindsym $mod+y exec $browser $newwindow https://mail.google.com/tasks/ig

bindsym $mod+n exec $filemanager

bindsym XF86Documents exec libreoffice --minimized --nologo --writer
bindsym $mod+g exec gvim

bindsym XF86Calculator exec gnome-terminal -x orpie

bindsym XF86Phone exec $browser $newwindow http://voice.google.com

bindsym Print exec sc --dir ~/screenshots --timestamp screenshot -o e
#bindsym $mod+Print exec sc -w --dir ~/screenshots --timestamp window
bindsym $mod+Print exec sc -b --dir ~/screenshots --timestamp box -o e

###########################
# LIFE, DEATH, and SLEEPING
###########################

# kill focused window
bindsym $mod+Shift+C kill

# start dmenu (a program launcher)
bindsym $mod+p exec dmenu_run

# reload the configuration file
bindsym $mod+Shift+R reload

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3 -- I tend to reload instead)
bindsym $mod+Shift+U restart

# exit i3 (logs you out of your X session)
bindsym $mod+Shift+Q exit

# shutdown the computer: sudo chmod u+s /sbin/poweroff
bindsym $mod+Ctrl+Shift+P exec poweroff -p
bindsym $mod+Ctrl+Shift+R exec reboot

#bindsym XF86Sleep exec echo -n mem > /sys/power/state

#######################
# FOCUS
#######################

# change focus
bindsym $mod+$l focus left
bindsym $mod+$r focus right
bindsym $mod+$d focus down
bindsym $mod+$u focus up

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
bindsym $mod+o focus child

popup_during_fullscreen leave_fullscreen

#######################
# MOVEMENT
#######################
# move focused window
bindsym $mod+Shift+$L move left
bindsym $mod+Shift+$R move right
bindsym $mod+Shift+$D move down
bindsym $mod+Shift+$U move up

#######################
# WINDOW CONTROL
#######################

# split container in horizontal orientation
bindsym $mod+h split horizontal

# split container in vertical orientation
bindsym $mod+v split vertical

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# change container layout (stacked, tabbed, default)
bindsym $mod+s layout stacking
bindsym $mod+t layout tabbed
bindsym $mod+d layout default
bindsym $mod+b layout splitv
bindsym $mod+w layout splith

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

#######################
# WORKSPACES
#######################

# switch to workspace
bindsym $mod+1 workspace 1:w1
bindsym $mod+2 workspace 2:w2
bindsym $mod+3 workspace 3:music
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
# bindsym $mod+9 workspace 9
# bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+Shift+exclam move workspace 1:w1
bindsym $mod+Shift+at move workspace 2:w2
bindsym $mod+Shift+numbersign move workspace 3:music
bindsym $mod+Shift+dollar move workspace 4
bindsym $mod+Shift+percent move workspace 5
bindsym $mod+Shift+asciicircum move workspace 6
bindsym $mod+Shift+ampersand move workspace 7
bindsym $mod+Shift+asterisk move workspace 8
#bindsym $mod+Shift+parenleft move workspace 9
#bindsym $mod+Shift+parenright move workspace 10

#######################
# RESIZE
#######################

# resize window (you can also use the mouse for that - (Alt-right-click))
# I only grow windows, never shrink

#bindsym $l resize shrink left 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$L resize grow   left 10 px or 10 ppt

#bindsym l resize shrink right 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$R resize grow   right 10 px or 10 ppt

#bindsym j resize shrink down 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$D resize grow   down 10 px or 10 ppt

#bindsym k resize shrink up 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$U resize grow   up 10 px or 10 ppt

mode "resize" {
    bindsym $mod+Ctrl+Shift+$R resize shrink   left 10 px or 10 ppt
    bindsym $mod+Ctrl+Shift+$L resize shrink   right 10 px or 10 ppt
    bindsym $mod+Ctrl+Shift+$U resize shrink   down 10 px or 10 ppt
    bindsym $mod+Ctrl+Shift+$D resize shrink   up 10 px or 10 ppt

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

set $iclickerdata /home/jtprince/Dropbox/481-Fall2013/iclicker/current-poll.csv
mode "iclicker" {
    bindsym s exec "iclickerpoll.py --type alpha --dest $iclickerdata --frequency 'cb'

    # duplicate these
    bindsym f exec killall iclickerpoll.py -s SIGINT; exec iclicker-plot.rb -s $iclickerdata; mode "default"
    bindsym space exec killall iclickerpoll.py -s SIGINT; exec iclicker-plot.rb -s $iclickerdata; mode "default"

    bindsym e mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}


bindsym $mod+Shift+I mode "iclicker"

## this is cool because it shows you how to use modes... unfortunately it is
## too much work and I just use the ones I care about without a 'mode'
## uncomment if you want to try it out

#mode "resize" {
#    # These bindings trigger as soon as you enter the resize mode
#
#    # They resize the border in the direction you pressed, e.g.
#    # when pressing left, the window is resized so that it has
#    # more space on its left
#
#    bindsym $l resize shrink left 10 px or 10 ppt
#    bindsym Shift+$L resize grow   left 10 px or 10 ppt
#
#    bindsym j resize shrink down 10 px or 10 ppt
#    bindsym Shift+J resize grow   down 10 px or 10 ppt
#
#    bindsym k resize shrink up 10 px or 10 ppt
#    bindsym Shift+K resize grow   up 10 px or 10 ppt
#
#    bindsym l resize shrink right 10 px or 10 ppt
#    bindsym Shift+L resize grow   right 10 px or 10 ppt
#
#    # same bindings, but for the arrow keys
#    bindsym Left resize shrink left 10 px or 10 ppt
#    bindsym Shift+Left resize grow   left 10 px or 10 ppt
#
#    bindsym Down resize shrink down 10 px or 10 ppt
#    bindsym Shift+Down resize grow   down 10 px or 10 ppt
#
#    bindsym Up resize shrink up 10 px or 10 ppt
#    bindsym Shift+Up resize grow   up 10 px or 10 ppt
#
#    bindsym Right resize shrink right 10 px or 10 ppt
#    bindsym Shift+Right resize grow   right 10 px or 10 ppt
#
#    # back to normal: Enter or Escape
#    bindsym Return mode "default"
#    bindsym Escape mode "default"
#}
#
#bindsym $mod+r mode "resize"


#######################
# BAR
#######################

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
  mode dock
  position bottom
  status_command status.rb
  # note: you need to set the primary output!, something like:
  # xrandr --output 'VGA1' --primary
  # discover the names of your connections
  # xrandr --current
  tray_output primary

  colors {
    background #465C86
    statusline #CFCFCF
    focused_workspace #FFFFFF #006600
    active_workspace #FFFFFF #006600
    inactive_workspace #CFCFCF #333333
    urgent_workspace #000000 #F00000
  }
}


#######################
# I3 SCRIPTING
#######################

## (turn this on if you are ready to start scripting things with i3:)

# create a socket for other processes to hook into
#ipc-socket ~/.i3/ipc.sock

######################################
# STARTUP PROGRAMS & SETTINGS (Late)
######################################

exec --no-startup-id autostart late

# note that you should mount these once with nautilus and remember the
# password, then you never have to type in the password!
# exec /usr/bin/ruby /home/jtprince/Dropbox/env/bin/mount_chem_dirs.rb --startup all
