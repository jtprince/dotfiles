# userguide: http://i3wm.org/docs/userguide.html

# use i3-get-window-critera to get window class, etc.
# use i3-unused-bindings to see which key combos are available
#
# xmodmap -pke # to see most keybindings
# use xev to interactively get most keynames
# use evtest to determine hard-to-get keynames (?? can these be used??)

######################################
# STARTUP PROGRAMS & SETTINGS (Early)
######################################

# exec --no-startup-id dbus-launch --sh-syntax --exit-with-session i3 -V -d all > ~/.config/i3/i3log-$(date +'%F-%k-%M-%S') 2>&1
exec --no-startup-id autostart
# in /etc/profile.d/jre.sh
exec --no-startup-id export _JAVA_AWT_WM_NONREPARENTING=1

#########################
# VARIABLES
#########################

## set to Win (then swap Alt and Win with evdev or xmodmap etc.)
# alt=Mod1 win=Mod4
set $mod Mod4
# MAC - keyboard (if not using plugged in keyboard)
#set $mod Mod1
## left
set $l Tab
## right
set $r l
## down
set $d j
## up
set $u k
## left (with shift held down)
set $L Tab
## right (with shift held down)
set $R L
## down (with shift held down)
set $D J
## up (with shift held down)
set $U K

#########################
# APPEARANCE
#########################

# font for window titles. ISO 10646 = Unicode
#font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
#font pango:Telegrama 10

# most PC's
set $globalfontsize 8
# MAC (intel card)
#set $globalfontsize 12
# MAC (nvidia card)
#set $globalfontsize 5

font pango:Droid Sans Mono $globalfontsize

# colors                    border      background  text
client.focused              #C35817     #006600     #FFFFFF
client.focused_inactive     #77994B     #465C86     #FFFFFF
client.unfocused            #465C86     #333333     #CFCFCF
client.urgent               #F00000     #F00000     #000000

#########################
# KEYBOARD KEYS
#########################

## screen backlight
# note that you also need to create file </etc/udev/rules.d/97-intel_backlight.rules> with contents (no #):
# KERNEL=="intel_backlight", SUBSYSTEM=="backlight", RUN+="/usr/bin/chmod 666 /sys/class/backlight/%k/brightness"
#
# Also: need systemd file with this command: setpci -v -H1 -s 00:01.00 BRIDGE_CONTROL=0
# (see Dropbox/env/backlight for example file)
# https://bbs.archlinux.org/viewtopic.php?id=167209
# udevadm control --reload  # or maybe reboot
# common options: acpi_video0 acpi_video1 intel_backlight gmux_backlight (Macbook Pro)
set $backlight acpi_video0
set $majorlightadjust 15
set $mediumlightadjust 4
set $lowlightadjust 2
set $finelightadjust 1

bindsym XF86MonBrightnessDown exec --no-startup-id laptop_monitor_brightness $backlight '-' $majorlightadjust
bindsym XF86MonBrightnessUp exec --no-startup-id laptop_monitor_brightness $backlight '+' $majorlightadjust
bindsym $mod+XF86MonBrightnessDown exec --no-startup-id laptop_monitor_brightness $backlight '-' $mediumlightadjust
bindsym $mod+XF86MonBrightnessUp exec --no-startup-id laptop_monitor_brightness $backlight '+' $mediumlightadjust
bindsym $mod+Shift+XF86MonBrightnessDown exec --no-startup-id laptop_monitor_brightness $backlight '-' $lowlightadjust
bindsym $mod+Shift+XF86MonBrightnessUp exec --no-startup-id laptop_monitor_brightness $backlight '+' $lowlightadjust
bindsym $mod+Ctrl+Shift+XF86MonBrightnessDown exec --no-startup-id laptop_monitor_brightness $backlight '-' $finelightadjust
bindsym $mod+Ctrl+Shift+XF86MonBrightnessUp exec --no-startup-id laptop_monitor_brightness $backlight '+' $finelightadjust

## keyboard backlights
# (macbook)
# keyboard backlights (need kbdlight package installed)
# yaourt -S kbdlight
# bindsym XF86KbdBrightnessDown exec --no-startup-id kbdlight down
# bindsym XF86KbdBrightnessUp exec --no-startup-id kbdlight up

# (asus)
bindsym XF86KbdBrightnessDown exec --no-startup-id asus-kbd-backlight down
bindsym XF86KbdBrightnessUp exec --no-startup-id asus-kbd-backlight up

# TODO: fix this:
# bindsym XF86ToggleTouchpad exec --no-startup-id

# favorites #1 key
bindsym XF86Launch5 exec --no-startup-id laptop-keyboard keyboard toggle

#########################
# SOUND
#########################

## parentheses left and right to change volume
set $volup exec --no-startup-id /usr/bin/pulseaudio-ctl up
set $voldown exec --no-startup-id /usr/bin/pulseaudio-ctl down
set $mute exec --no-startup-id /usr/bin/pulseaudio-ctl mute
set $mutefor exec --no-startup-id mute-for

bindsym $mod+parenright $volup 2
bindsym $mod+parenleft $voldown 2
bindsym $mod+Shift+parenright $volup 5
bindsym $mod+Shift+parenleft $voldown 5
bindsym $mod+Ctrl+Shift+parenright $volup 20
bindsym $mod+Ctrl+Shift+parenleft $voldown 20
bindsym $mod+minus $mute
bindsym $mod+Ctrl+Shift minus $mutefor 27
bindsym $mod+Shift minus $mutefor 13

bindsym XF86AudioRaiseVolume $volup 4
bindsym XF86AudioLowerVolume $voldown 4
bindsym XF86AudioMute $mute

#########################
# Music player
#########################
set $playpause exec --no-startup-id playerctl-prince play-pause
set $nextsong exec --no-startup-id playerctl-prince next
set $previoussong exec --no-startup-id playerctl-prince previous

# commands for music player
bindsym XF86AudioPlay $playpause
bindsym XF86AudioNext $nextsong
bindsym XF86AudioPrev $previoussong
# key 1 on my microsoft keyboard
# shuffle the playlist
#bindsym XF86Launch5 exec mpc shuffle
#
bindsym $mod+p $playpause
bindsym $mod+bracketright $nextsong
bindsym $mod+bracketleft $previoussong

mode "musicplayer" {
    bindsym Shift+M exec mpd

    bindsym Return exec mpc play
    bindsym Shift+less exec mpc prev
    bindsym Shift+greater exec mpc next

    bindsym BackSpace mpc seek 0

    bindsym s exec mpc stop
    bindsym Shift+P exec mpc toggle  # pause/play
    bindsym Shift+Z exec mpc random

    bindsym q exec mpd --kill
    bindsym Shift+Q exec mpd --kill

    bindsym Escape mode "default"
    bindsym $mod+m mode "default"
}

bindsym $mod+m mode "musicplayer"
#########################
# DEFAULTS
#########################

## workspace Layout <default|stacking|tabbed>
workspace_layout stacking

## focus follows mouse <yes|no>
focus_follows_mouse no

## border style for new windows <normal|1pixel|none>
new_window normal

## border style for for floating windows <normal|1pixel|none>
new_float 1pixel

# hit same workspace focus key *again* and returns to previously focused
workspace_auto_back_and_forth yes

## orientation for new workspaces <horizontal|vertical|auto>
default_orientation vertical

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

#force_focus_wrapping yes

#########################
# MOVEMENT PARADIGM
#########################

# mod + <X> => move focus
# mod + Shift + <X> => move focus with selection
# mod + Ctrl + Shift + <X> => move selection (but not focus)

#########################
# WORKSPACE MOVEMENT
#########################

# move focus to next monitor
bindsym $mod+Right focus output right
bindsym $mod+Left focus output left

# move workspace and focus to next monitor
bindsym $mod+Shift+Right move workspace to output right; focus output right
bindsym $mod+Shift+Left move workspace to output left; focus output left

# just move workspace to next monitor
bindsym $mod+Ctrl+Shift+Right move workspace to output right
bindsym $mod+Ctrl+Shift+Left move workspace to output left

# move focus
bindsym $mod+period workspace next
bindsym $mod+comma workspace prev

# move with selection
bindsym $mod+Shift+period move container to workspace next; workspace next
bindsym $mod+Shift+comma move container to workspace prev; workspace prev

# just move selection
bindsym $mod+Ctrl+Shift+period move workspace next
bindsym $mod+Ctrl+Shift+comma move workspace prev

# go back to previously focused workspace
bindsym $mod+z workspace back_and_forth

# move selected to previously focused workspace and follow
bindsym $mod+Shift+z move container to workspace back_and_forth; workspace back_and_forth

# move selected to previously focused workspace
bindsym $mod+Ctrl+Shift+z move container to workspace back_and_forth

#########################
# Preferred applications
#########################
set $browser1 chromium
set $newwindow1 --new-window
set $browser2 chromium --user-data-dir=~/.config/chromium-doba
set $newwindow2 --new-window
set $browsertest chromium --user-data-dir=~/.config/chromium-test

bindsym $mod+x exec x-terminal-emulator

bindsym XF86HomePage exec $browser1
bindsym $mod+i exec $browser1
bindsym $mod+Shift+I exec $browser2
bindsym $mod+Ctrl+Shift+T exec $browsertest

bindsym XF86Mail exec $browser1 $newwindow1 http://gmail.com
bindsym $mod+e exec $browser1 $newwindow1 http://gmail.com
bindsym $mod+Shift+E exec $browser2 $newwindow2 http://gmail.com

bindsym $mod+c exec $browser1 $newwindow1 http://calendar.google.com
bindsym $mod+Ctrl+Shift+C exec $browser2 $newwindow2 http://calendar.google.com

bindsym $mod+y exec $browser1 $newwindow1 https://mail.google.com/tasks/ig
bindsym $mod+Shift+Y exec $browser2 $newwindow2 https://mail.google.com/tasks/ig

bindsym $mod+Ctrl+Shift+I exec open-clipboard-url

bindsym $mod+n exec file-manager

bindsym $mod+Shift+T exec todo

bindsym XF86Documents exec libreoffice --minimized --nologo --writer
bindsym $mod+g exec gvim

bindsym XF86Calculator exec x-terminal-emulator -x python3

bindsym XF86Phone exec $browser1 $newwindow1 http://voice.google.com

bindsym Print exec sc --dir ~/screenshots --timestamp screenshot -o e
#bindsym $mod+Print exec sc -w --dir ~/screenshots --timestamp window
bindsym $mod+Print exec sc -b --dir ~/screenshots --timestamp box -o e

###########################
# Keyboard shortcuts
###########################

# F9 as middle click (paste primary)
bindcode 75 exec --no-startup-id xdotool click 2

# â˜† <Favorites> toggles monitor setting
bindsym XF86Favorites exec --no-startup-id monitor_toggle auto && randomise-bkg && xmodmap ~/.config/xmodmap
bindsym XF86Display exec --no-startup-id monitor_toggle auto && randomise-bkg && xmodmap ~/.config/xmodmap

###########################
# LIFE, DEATH, and SLEEPING
###########################

# kill focused window
bindsym $mod+Shift+C kill

# start dmenu (a program launcher)
bindsym $mod+Shift+P exec dmenu_run

# reload the configuration file
bindsym $mod+Shift+R reload

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3 -- I tend to reload instead)
bindsym $mod+Shift+U restart

# exit i3 (logs you out of your X session)
bindsym $mod+Shift+Q exit

# power/on-off management:
# note, you may need to: sudo chmod u+s /sbin/poweroff
bindsym $mod+Ctrl+Shift+P exec --no-startup-id systemctl poweroff
bindsym $mod+Ctrl+Shift+R exec --no-startup-id systemctl reboot
# suspend (RAM)
bindsym $mod+Ctrl+Shift+S exec --no-startup-id systemctl suspend
# turn off display (called as a shortcut it immediately wakes up w/o sleep added)
bindsym $mod+Ctrl+Shift+D exec sleep 1 && xset dpms force off

bindsym $mod+Ctrl+Shift+O exec fuzzy_lock

#bindsym XF86Sleep exec echo -n mem > /sys/power/state

#######################
# FOCUS
#######################

# change focus
bindsym $mod+$l focus left
bindsym $mod+$r focus right
bindsym $mod+$d focus down
bindsym $mod+$u focus up

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
bindsym $mod+Shift+A focus child

popup_during_fullscreen leave_fullscreen

#######################
# MOVEMENT
#######################
# move focused
bindsym $mod+Shift+$L move left
bindsym $mod+Shift+$R move right
bindsym $mod+Shift+$D move down
bindsym $mod+Shift+$U move up

#######################
# WINDOW CONTROL
#######################

# split container in horizontal orientation
bindsym $mod+h split horizontal

# split container in vertical orientation
bindsym $mod+v split vertical

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen
bindsym $mod+Ctrl+Shift+F fullscreen global

# change container layout (stacked, tabbed, default)
bindsym $mod+s layout stacking
bindsym $mod+t layout tabbed
bindsym $mod+d layout default
bindsym $mod+b layout splitv
bindsym $mod+w layout splith

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle


#######################
# WORKSPACES
#######################

set $ws1 1:w1
set $ws2 2:w2
set $ws3 3:w3
set $ws4 4:w4
set $ws5 5:w5
set $ws6 6:w6
set $ws7 7:w7
set $ws8 8:w8

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
# bindsym $mod+9 workspace 9
# bindsym $mod+0 workspace 10

# move focused container to workspace and follow
bindsym $mod+Shift+exclam move container to workspace $ws1; workspace $ws1
bindsym $mod+Shift+at move container to workspace $ws2; workspace $ws2
bindsym $mod+Shift+numbersign move container to workspace $ws3; workspace $ws3
bindsym $mod+Shift+dollar move container to workspace $ws4; workspace $ws4
bindsym $mod+Shift+percent move container to workspace $ws5; workspace $ws5
bindsym $mod+Shift+asciicircum move container to workspace $ws6; workspace $ws6
bindsym $mod+Shift+ampersand move container to workspace $ws7; workspace $ws7
bindsym $mod+Shift+asterisk move container to workspace $ws8; workspace $ws8

# move focused container to workspace
bindsym $mod+Ctrl+Shift+exclam move workspace $ws1
bindsym $mod+Ctrl+Shift+at move workspace $ws2
bindsym $mod+Ctrl+Shift+numbersign move workspace $ws3
bindsym $mod+Ctrl+Shift+dollar move workspace $ws4
bindsym $mod+Ctrl+Shift+percent move workspace $ws5
bindsym $mod+Ctrl+Shift+asciicircum move workspace $ws6
bindsym $mod+Ctrl+Shift+ampersand move workspace $ws7
bindsym $mod+Ctrl+Shift+asterisk move workspace $ws8

#######################
# App/Window Prefs
#######################

for_window [title="Hangouts"] move container to workspace $ws7
for_window [window_role="pop-up"] floating enabled
#for_window [class="Hangouts"] floating enable

#######################
# RESIZE
#######################

# resize window (you can also use the mouse for that - (Alt-right-click))
# I only grow windows outside of resize mode

#bindsym $l resize shrink left 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$L resize grow   left 10 px or 10 ppt

#bindsym l resize shrink right 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$R resize grow   right 10 px or 10 ppt

#bindsym j resize shrink down 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$D resize grow   down 10 px or 10 ppt

#bindsym k resize shrink up 10 px or 10 ppt
bindsym $mod+Ctrl+Shift+$U resize grow   up 10 px or 10 ppt

mode "resize" {
    bindsym $mod+Ctrl+Shift+$R resize shrink left 10 px or 10 ppt
    bindsym $mod+Ctrl+Shift+$L resize shrink right 10 px or 10 ppt
    bindsym $mod+Ctrl+Shift+$U resize shrink down 10 px or 10 ppt
    bindsym $mod+Ctrl+Shift+$D resize shrink up 10 px or 10 ppt

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

#######################
# MISC - editing
#######################
bindsym $mod+Shift+F exec pylint-patch fix
bindsym $mod+Shift+G exec pylint-patch auto
bindsym $mod+Shift+D exec pylint-patch delete
bindsym $mod+Shift+O exec pylint-patch top

bindsym $mod+Shift+M exec fix

#######################
# BAR
#######################

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)

## MISSING YOUR ICONS??!!! You probably need to configure your primary output!
# xrandr --output <output> --primary

bar {
  mode dock
  position bottom
  font pango:Droid Sans Mono, Icons $globalfontsize
  status_command status.rb

  # note: you need to set the primary output!, something like:
  # xrandr --output 'VGA1' --primary
  # discover the names of your connections
  # xrandr --current
  tray_output primary

  colors {
    background #465C86
    statusline #CFCFCF
    separator #465C86
    focused_workspace #FFA500 #003300
    active_workspace #FFFFFF #006600
    inactive_workspace #CFCFCF #333333
    urgent_workspace #000000 #F00000
  }
}

#######################
# I3 SCRIPTING
#######################

## (turn this on if you are ready to start scripting things with i3:)

# create a socket for other processes to hook into
#ipc-socket ~/.i3/ipc.sock

######################################
# STARTUP PROGRAMS & SETTINGS (Late)
######################################

exec --no-startup-id autostart late
